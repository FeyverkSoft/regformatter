var RegFormatter=function(){function n(i){var f=this,e=i.element,o;if(e&&e.tagName.toUpperCase()!=="INPUT"&&e.tagName.toUpperCase()!=="TEXTAREA")throw"Element should be <input />";if(!i.format&&!i.formats)throw"Format is not specified";if(this.element=e,o=i.formats||[],i.format&&o.unshift(i.format),this.reset(o),e){var s=function(t){var o,e;if(t=t||window.event,o=t.keyCode||t.charCode,o===8||o===46){if(!f.element.value)return;var h=r(f.element),i=h.selectionStart,s=h.selectionEnd;i===s&&(o===8?i--:s=i+1);e=f.write("",f.element.value,i,s);e&&(f.element.value=e.value,f.oldValue=e.value,i>e.value.length&&(i=e.value.length),n.setCaretPosition(f.element,i),u(t))}},h=function(t){if(t=t||window.event,!t.ctrlKey&&(!t.key||!(t.key.length>1))){var h=String.fromCharCode(t.keyCode||t.charCode),e=r(f.element),o=e.selectionStart,s=e.selectionEnd,i=f.write(h,f.element.value,o,s===o?null:s);i&&(f.element.value=i.value,f.oldValue=i.value,n.setCaretPosition(f.element,i.position+1));u(t)}},c=function(){var t=f.write(f.element.value,"",0);t?(f.element.value=t.value,f.oldValue=t.value,n.setCaretPosition(f.element,t.value.length)):f.element.value=f.oldValue},l=function(t){var e;if(t=t||window.event,e=t.clipboardData.getData("text/plain"),e){var o=r(f.element),s=o.selectionStart,h=o.selectionEnd,i=f.write(e,f.element.value,s,h===s?null:h);i&&(f.element.value=i.value,f.oldValue=i.value,n.setCaretPosition(f.element,i.position+1))}u(t)},a=function(){var i=r(f.element),u=i.selectionStart,e=i.selectionEnd,t=f.write("",f.element.value,u,e===u?null:e);t&&setTimeout(function(){f.element.value=t.value;f.oldValue=t.value;n.setCaretPosition(f.element,t.position)},10)};t(e,"keydown",s);t(e,"keypress",h);t(e,"input",c);t(e,"paste",l);t(e,"cut",a)}}var i;Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0;i<this.length;i++)if(this[i]===n)return i;return-1});Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});var t=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i)},u=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},r=function(n){if(document.selection){n.focus();var t=document.selection.createRange(),i=t.text.length;return t.moveStart("character",-n.value.length),{selectionStart:t.text.length-i,selectionEnd:t.text.length}}return{selectionStart:n.selectionStart,selectionEnd:n.selectionEnd}};return n.setCaretPosition=function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},i=function(n){for(var i="",t=0;t<n.length;t++)i+=n[t].value;return i},n.prototype.reset=function(n){var v=[],p,r,ft,c,l,o,d,a,w,g,b,nt,tt;if(typeof n=="string")v.push(n);else if(Array.isArray(n))v=n.concat();else throw"Invalid argument 'format'";var et=[".","[","]","(",")","+","-","*","?","{","}","|","/","^","$"],it=["%","[","(","{"],rt=["%","]",")","}"],ot=["+","*","|","^","$"],st=["{","?"],h=[],e=[],t="",u=!1,y=!1,f=[],k="",i,s=function(r){t===""||r&&(f.length>1||i+1<n.length&&st.indexOf(n.charAt(i+1))>=0)||(e.push({value:t,isExp:r}),k+=t,t="")},ut=function(n,t,i){for(var r,f,s,e,v,o,y,c,l,a,u=t;u>=0;u--)if(r=n[u],r.isExp&&Array.isArray(r.value)){for(f=0;f<r.value.length;f++){for(s=Array.isArray(r.value[f])?r.value[f]:[r.value[f]],e=0;e<s.length;e++)s[e].value===""&&(s.splice(e,1),e--);ut(n,u-1,s.concat(i))}break}else i.unshift(r);if(u<=0){for(v=!1,o=0;o<h.length;o++)if(h[o].length===i.length){for(y=!0,c=0;c<h[o].length;c++)l=h[o][c],a=i[c],l.isExp===a.isExp&&l.value.length===a.value.length&&l.value===a.value||(y=!1);if(y){v=!0;break}}v||h.push(i)}};for(p=0;p<v.length;p++){for(n=v[p],e=[],t="",u=!1,y=!1,f=[],k="",i=0;i<n.length;i++){if(r=n.charAt(i),y){t+=r;y=!1;s(u);continue}if(r==="\\"){t+=r;y=!0;continue}if(r==="%")if(u)if(f.length&&f[f.length-1]==="%"){f.pop();s(u);u=!1;continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";else{f.push(r);s(u);u=!0;continue}if(!u){t+=et.indexOf(r)>=0?"\\"+r:r;s(u);continue}if(it.indexOf(r)>=0){f.push(r);t+=r;s(u);continue}if(rt.indexOf(r)>=0)if(f.length&&f[f.length-1]===it[rt.indexOf(r)]){f.pop();t+=r;s(u);continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";if(ot.indexOf(r)>=0){t+="\\"+r;s(u);continue}t+=r;s(u)}if(f.length)throw"Invalid pattern '"+n+"' at position "+(n.length-1)+" '"+n[n.length-1]+"'";for(ft=new RegExp(k),ft=null,i=0;i<e.length;i++)if(t=e[i],t.isExp)if(c=/\{(\d)\}$/,l=c.exec(t.value),l){for(o=parseInt(l[1]),t.value=t.value.replace(c,""),e.splice(i,1),d=0;d<o;d++)e.splice(i,0,t);i+=o-1}else if(/(^|[^\\])\{(\d)\}/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(i=0;i<e.length;i++)if(t=e[i],t.isExp)if(/[^\\]\{(\d),(\d)\}$/.test(t.value)){if(c=/\{(\d),(\d)\}$/,l=c.exec(t.value),a=parseInt(l[1]),w=parseInt(l[2]),!a||!w||a<1||a>w)throw"Invalid pattern '"+n+"' in '"+t.value+"'";if(t.value=t.value.replace(c,""),!t.value)throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(g=[],b=[],o=0;o<a-1;o++)b.push(t);for(o=a;o<=w;o++)b.push(t),g.push(b.concat());e.splice(i,1,{value:g,isExp:t.isExp})}else if(/[^\\]\?$/.test(t.value))t.value=t.value.replace(/\?$/,""),e.splice(i,1,{value:[{value:"",isExp:t.isExp},t],isExp:t.isExp});else if(/(^|[^\\])(\{(\d),(\d)\})|\?/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";ut(e,e.length-1,[])}this.formats=v;this.patterns=h;this.element&&(nt=this.element.value,nt&&(tt=this.write(nt,"",0,0),this.element.value=tt?tt.value:"",this.oldValue=this.element.value))},n.prototype.value=function(n){var u=this,f="",t,r,e;for(n=n!=undefined?n:this.element?this.element.value:"",r=null,t=0;t<u.patterns.length;t++)if(r=u.patterns[t].slice(0,n.length),new RegExp("^"+i(r)+"$").test(n))break;else r=null;if(!r)return null;for(t=0;t<r.length;t++)r[t].isExp&&(e=n.match(new RegExp("^"+i(r.slice(0,t+1)))),f+=e[0].replace(new RegExp("^"+i(r.slice(0,t))),""));return f},n.prototype.write=function(n,t,r,u){var a=this.value(t),v,y,s,w,h,o,k,l,d,g;if(a===""&&n==="")return{value:"",position:0};if(u){var b=this.value(t.substring(0,r)),nt=this.value(t.substring(0,u)),tt=a.substring(nt.length);v=b+n+tt;y=b.length}else s=this.value(t.substring(0,r)),w=a.substring(s.length),v=s+n+w,y=s.length;for(h=0;h<this.patterns.length;h++){var c=this.patterns[h],e=v,p=y,f=1;for(o=0;o<c.length;o++){for(k=c.slice(0,o+1),l=null;f<=e.length;)if(d=e.substring(0,f),l=new RegExp("^"+i(k)+"$").exec(d),l){f++;break}else if(c[o].isExp){f++;continue}else{g=c[o].value.replace(/^\\/,"");e=e.substring(0,f-1)+g+e.substring(f-1);f<p+n.length+1&&p++;continue}if(f>e.length){if(l)return{value:e,position:p+(n.length>0?n.length-1:0)};break}}}return null},n}();
//# sourceMappingURL=regformatter.min.js.map
