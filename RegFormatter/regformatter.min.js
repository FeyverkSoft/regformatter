var RegFormatter=function(){function n(t,i){var r=this,f;if(t&&t.tagName.toUpperCase()!=="INPUT"&&t.tagName.toUpperCase()!=="TEXTAREA")throw"Element should be <input />";if(!i.format&&!i.formats)throw"Format is not specified";this.element=t;f=i.formats||[];i.format&&f.unshift(i.format);this.reset(f);var u,e=function(t){var i,f,o,e;if(r.element&&(u=n.getCaretPosition(r.element),t=t||window.event,i=t.keyCode||t.charCode,i===8||i===46||i===229&&t.keyIdentifier&&t.keyIdentifier==="U+0008")){if(!r.element.value)return;f=u.selectionStart;o=u.selectionEnd;f===o&&(i===8?f--:o=f+1);e=r.write("",r.element.value,f,o);e&&(n.preventEvent(t),r.element.value=e.value,r.oldValue=e.value,n.setCaretPosition(r.element,e.position))}},o=function(t){var i;if(r.element&&(t=t||window.event,!t.ctrlKey&&(!t.key||!(t.key.length>1))&&(t.keyCode||t.charCode)!==13)){if(t.which==null)i=String.fromCharCode(t.keyCode);else if(t.which!==0&&t.charCode!==0)i=String.fromCharCode(t.which);else return;if(i){u=n.getCaretPosition(r.element);var e=u.selectionStart,o=u.selectionEnd,f=r.write(i,r.element.value,e,o===e?null:o);f&&(r.element.value=f.value,r.oldValue=f.value,n.setCaretPosition(r.element,f.position));n.preventEvent(t)}}},s=function(t){var i;if(r.element&&(t=t||window.event,u=n.getCaretPosition(r.element),n.preventEvent(t),i=t.data,console.log(i),i)){var e=u.selectionStart,o=u.selectionEnd,f=r.write(i,r.element.value,e,o===e?null:o);f&&(r.element.value=f.value,r.oldValue=f.value,n.setCaretPosition(r.element,f.position))}},h=function(){var i,f,t;if(r.element){u||(u=n.getCaretPosition(r.element));i=u.selectionStart;f=u.selectionEnd;u=null;var e=r.oldValue||"",s=e.substring(0,i),h=e.substring(f),o=r.element.value.substring(s.length);o=o.substring(0,o.length-h.length);t=r.write(o,e,i,f===i?null:f);t?(r.element.value=t.value,r.oldValue=t.value,n.setCaretPosition(r.element,t.position)):r.element.value=e}},c=function(t){var i,e;if(r.element&&(t=t||window.event,u=n.getCaretPosition(r.element),i=t.clipboardData||window.clipboardData,i&&i.getData)){if(e=i.getData("text/plain"),e){var o=u.selectionStart,s=u.selectionEnd,f=r.write(e,r.element.value,o,s===o?null:s);f&&(r.element.value=f.value,r.oldValue=f.value,n.setCaretPosition(r.element,f.position))}n.preventEvent(t)}},l=function(){if(r.element){u=n.getCaretPosition(r.element);var i=u.selectionStart,f=u.selectionEnd,t=r.write("",r.element.value,i,f===i?null:f);t&&setTimeout(function(){r.element.value=t.value;r.oldValue=t.value;n.setCaretPosition(r.element,t.position)},10)}};t&&(n.addEvent(t,"keydown",e),n.addEvent(t,"keypress",o),n.addEvent(t,"beforeinput",s),n.addEvent(t,"input",h),n.addEvent(t,"paste",c),n.addEvent(t,"cut",l));n.prototype.destroy=function(){var t=this;t.element&&(n.removeEvent(t.element,"keydown",e),n.removeEvent(t.element,"keypress",o),n.removeEvent(t.element,"beforeinput",s),n.removeEvent(t.element,"input",h),n.removeEvent(t.element,"paste",c),n.removeEvent(t.element,"cut",l));t.formats=null;t.patterns=null;t.oldValue=null;t.element=null;delete t.formats;delete t.patterns;delete t.oldValue;delete t.element;delete t}}Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0;i<this.length;i++)if(this[i]===n)return i;return-1});Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});var t=function(n){for(var i="",t=0;t<n.length;t++)i+=n[t].value;return i};return n.addEvent=function(n,t,i){n&&t&&i&&(n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i))},n.removeEvent=function(n,t,i){n&&t&&i&&(n.removeEventListener?n.removeEventListener(t,i):n.detachEvent("on"+t,i))},n.preventEvent=function(n){n&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},n.getCaretPosition=function(n){if(!n)return null;if(document.selection){n.focus();var t=document.selection.createRange(),i=t.text.length;return t.moveStart("character",-n.value.length),{selectionStart:t.text.length-i,selectionEnd:t.text.length}}return{selectionStart:n.selectionStart,selectionEnd:n.selectionEnd}},n.setCaretPosition=function(n,t){if(n&&t)if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},n.prototype.reset=function(n){var v=[],p,r,ft,c,l,o,d,a,w,g,b,nt,tt;if(typeof n=="string")v.push(n);else if(Array.isArray(n))v=n.concat();else throw"Invalid argument 'format'";var et=[".","[","]","(",")","+","-","*","?","{","}","|","/","^","$"],it=["%","[","(","{"],rt=["%","]",")","}"],ot=["+","*","|","^","$"],st=["{","?"],h=[],e=[],t="",u=!1,y=!1,f=[],k="",i,s=function(r){t===""||r&&(f.length>1||i+1<n.length&&st.indexOf(n.charAt(i+1))>=0)||(e.push({value:t,isExp:r}),k+=t,t="")},ut=function(n,t,i){for(var r,f,s,e,v,o,y,c,l,a,u=t;u>=0;u--)if(r=n[u],r.isExp&&Array.isArray(r.value)){for(f=0;f<r.value.length;f++){for(s=Array.isArray(r.value[f])?r.value[f]:[r.value[f]],e=0;e<s.length;e++)s[e].value===""&&(s.splice(e,1),e--);ut(n,u-1,s.concat(i))}break}else i.unshift(r);if(u<=0){for(v=!1,o=0;o<h.length;o++)if(h[o].length===i.length){for(y=!0,c=0;c<h[o].length;c++)l=h[o][c],a=i[c],l.isExp===a.isExp&&l.value.length===a.value.length&&l.value===a.value||(y=!1);if(y){v=!0;break}}v||h.push(i)}};for(p=0;p<v.length;p++){if(n=v[p],n==="*"){h.push([{value:".*",isExp:!0}]);continue}for(e=[],t="",u=!1,y=!1,f=[],k="",i=0;i<n.length;i++){if(r=n.charAt(i),y){t+=r;y=!1;s(u);continue}if(r==="\\"){t+=r;y=!0;continue}if(r==="%")if(u)if(f.length&&f[f.length-1]==="%"){f.pop();s(u);u=!1;continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";else{f.push(r);s(u);u=!0;continue}if(!u){t+=et.indexOf(r)>=0?"\\"+r:r;s(u);continue}if(it.indexOf(r)>=0){f.push(r);t+=r;s(u);continue}if(rt.indexOf(r)>=0)if(f.length&&f[f.length-1]===it[rt.indexOf(r)]){f.pop();t+=r;s(u);continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";if(ot.indexOf(r)>=0){t+="\\"+r;s(u);continue}t+=r;s(u)}if(f.length)throw"Invalid pattern '"+n+"' at position "+(n.length-1)+" '"+n[n.length-1]+"'";for(ft=new RegExp(k),ft=null,i=0;i<e.length;i++)if(t=e[i],t.isExp)if(c=/\{(\d)\}$/,l=c.exec(t.value),l){for(o=parseInt(l[1]),t.value=t.value.replace(c,""),e.splice(i,1),d=0;d<o;d++)e.splice(i,0,t);i+=o-1}else if(/(^|[^\\])\{(\d)\}/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(i=0;i<e.length;i++)if(t=e[i],t.isExp)if(/[^\\]\{(\d+),(\d+)\}$/.test(t.value)){if(c=/\{(\d+),(\d+)\}$/,l=c.exec(t.value),a=parseInt(l[1]),w=parseInt(l[2]),!a||!w||a<1||a>w)throw"Invalid pattern '"+n+"' in '"+t.value+"'";if(t.value=t.value.replace(c,""),!t.value)throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(g=[],b=[],o=0;o<a-1;o++)b.push(t);for(o=a;o<=w;o++)b.push(t),g.push(b.concat());e.splice(i,1,{value:g,isExp:t.isExp})}else if(/[^\\]\?$/.test(t.value))t.value=t.value.replace(/\?$/,""),e.splice(i,1,{value:[{value:"",isExp:t.isExp},t],isExp:t.isExp});else if(/(^|[^\\])(\{(\d+),(\d+)\})|\?/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";ut(e,e.length-1,[])}this.formats=v;this.patterns=h;this.element&&(nt=this.element.value,nt&&(tt=this.write(nt,"",0,0),this.element.value=tt?tt.value:"",this.oldValue=this.element.value))},n.prototype.value=function(n){var u=this,f="",i,r,e;if(n=n!=undefined?n:this.element?this.element.value:"",!n)return"";for(r=null,i=0;i<u.patterns.length;i++){if(u.patterns[i].length===1&&u.patterns[i][0].isExp&&u.patterns[i][0].value===".*")return n;if(r=u.patterns[i].slice(0,n.length),new RegExp("^"+t(r)+"$").test(n))break;else r=null}if(!r)return null;for(i=0;i<r.length;i++)r[i].isExp&&(e=n.match(new RegExp("^"+t(r.slice(0,i+1)))),f+=e[0].replace(new RegExp("^"+t(r.slice(0,i))),""));return f},n.prototype.write=function(n,i,r,u){var c=this.value(i||""),l,a,o,v,k,y,f,h,d,w,g,b;if(typeof c=="undefined"||c===null||!c&&!n)return{value:"",position:0};if(u?(o=this.value(i.substring(0,r)),v=this.value(i.substring(0,u)),k=c.substring(v.length),l=o+n+k,a=o.length):(o=this.value(i.substring(0,r)),v=c.substring(o.length),l=o+n+v,a=o.length),!l)return{value:l||"",position:a};for(y=0;y<this.patterns.length;y++){var s=this.patterns[y],e=l,p=a;if(s.length===1&&s[0].isExp&&s[0].value===".*")return{value:e,position:p+n.length};for(f=1,h=0;h<s.length;h++){for(d=s.slice(0,h+1),w=null;f<=e.length;)if(g=e.substring(0,f),w=new RegExp("^"+t(d)+"$").exec(g),w){f++;break}else if(s[h].isExp){f++;continue}else{b=s[h].value.replace(/^\\/,"");e=e.substring(0,f-1)+b+e.substring(f-1);f<p+n.length+b.length&&(p+=b.length);continue}if(f>e.length){if(w)return{value:e,position:p+n.length};break}}}return null},n}();
//# sourceMappingURL=regformatter.min.js.map
