var RegFormatter=function(){function n(n){var r=this,o=n.element,i,a,v,y,p,w,b,k;if(o&&o.tagName.toUpperCase()!=="INPUT")throw"Element should be <input />";this.element=o;i=n.format;this.format=i;for(var d="",f=[],h=[],u="",tt=[".","[","]","(",")","+","-","*","?","{","}","|","/","^","$"],g=["%","[","(","{"],nt=["%","]",")","}"],c=!1,l=!1,e=[],s=function(n){u===""||n&&(e.length>1||t+1<i.length&&i[t+1]==="{")||(d+=u,f.push(u),h.push(n),u="")},t=0;t<i.length;t++){if(l){u+=i[t];l=!1;s(c);continue}if(i[t]==="\\"){u+=i[t];l=!0;continue}if(i[t]==="%")if(c)if(e.length&&e[e.length-1]==="%"){e.pop();s(!0);c=!1;continue}else throw"Invalid pattern '"+i+"' at position "+t+" '"+i[t]+"'";else{e.push(i[t]);s(!1);c=!0;continue}if(!c){u+=tt.indexOf(i[t])>=0?"\\"+i[t]:i[t];s(!1);continue}if(g.indexOf(i[t])>=0){e.push(i[t]);u+=i[t];s(!0);continue}if(nt.indexOf(i[t])>=0)if(e.length&&e[e.length-1]===g[nt.indexOf(i[t])]){e.pop();u+=i[t];s(!0);continue}else throw"Invalid pattern '"+i+"' at position "+t+" '"+i[t]+"'";u+=i[t];s(!0)}if(e.length)throw"Invalid pattern '"+i+"' at position "+(i.length-1)+" '"+i[i.length-1]+"'";for(t=0;t<f.length;){if(h[t]&&(a=/\{(\d)\}$/,u=f[t],v=a.exec(u),v)){for(y=parseInt(v[1]),u=u.replace(a,""),f[t]=u,p=1;p<y;p++)f.splice(t,0,u),h.splice(t,0,!0);t+=y-1}t++}for(this.patternsOriginal=f.concat(),w=function(n,t){for(var u,s,c,f,e,o=!0,i=t;i<n.length;i++)if(h[i]&&(u=/\{(\d),(\d)\}$/.exec(n[i]),u)){for(o=!1,s=parseInt(u[1]),c=parseInt(u[2]),f=s;f<=c;f++)e=n.concat(),e[i]=e[i].replace(/\{(\d),(\d)\}$/,"{"+f+"}"),w(e,i+1);break}o&&r.patternsArr.push(n)},this.patternsArr=[],w(f,0),t=0;t<f.length;t++)/\{\d,\d\}/.test(f[t])&&(f[t]=f[t].replace(/\{\d,(\d)\}/,"{1,$1}"));this.pattern=d;this.patterns=f;this.exps=h;o&&(o.addEventListener("keydown",function(n){var u=n.keyCode||n.charCode,f,t,i,e;if(u===8||u===46){if(f=r.element.value,!f)return!1;if(t=r.element.selectionStart,i=r.element.selectionEnd,t===i&&(u===8?t--:i=t+1),e=r.write("",f,t,i),e)return r.element.value=e.value,r.element.selectionStart=r.element.selectionEnd=t,n.preventDefault(),!1}return!0}),o.addEventListener("keypress",function(n){var f=String.fromCharCode(n.keyCode||n.charCode),e=r.element.value,i=r.element.selectionStart,u=r.element.selectionEnd,t=r.write(f,e,i,u===i?null:u);return t&&(r.element.value=t.value,r.element.selectionStart=r.element.selectionEnd=t.position+1),n.preventDefault(),!1}),o.addEventListener("paste",function(n){var u=n.clipboardData.getData("text/plain");if(u){var e=r.element.value,t=r.element.selectionStart,f=r.element.selectionEnd,i=r.write(u,e,t,f===t?null:f);i&&(r.element.value=i.value,r.element.selectionStart=r.element.selectionEnd=t+i.value.length)}return n.preventDefault(),!1}),b=this.element.value,b&&(k=this.write(b,"",0,0),this.element.value=k?k.value:""))}return n.prototype.checkValue=function(n){var i=this.patternsOriginal.concat(),r,u,t,f;for(i.pop(),r=this.patterns.concat(),u=this.patterns.length,t=u;t>0;t--){if(f=i.join("")+r.pop(),new RegExp("^"+f+"$").test(n))return t;i.pop()}return 0},n.prototype.value=function(n){var r=this,u="",f,i,t,e;for(n=n!=undefined?n:this.element?this.element.value:"",f=function(n){var t=r.patternsOriginal.concat(),u,i;for(t.pop(),u=r.patterns.concat(),i=0;i<r.patterns.length;i++)if(t.push(u.pop()),new RegExp("^"+t.join("")+"$").test(n))break;else t.pop(),t.pop();return t},i=f(n),t=0;t<i.length;t++)this.exps[t]&&(e=n.match(new RegExp("^"+i.slice(0,t+1).join(""))),u+=e[0].replace(new RegExp("^"+i.slice(0,t).join("")),""));return u},n.prototype.write=function(n,t,i,r){var y=this.value(t),c,l,o,p,s,e,b,h,k,d;if(r){var w=this.value(t.substring(0,i)),g=this.value(t.substring(0,r)),nt=y.substring(g.length);c=w+n+nt;l=w.length}else o=this.value(t.substring(0,i)),p=y.substring(o.length),c=o+n+p,l=o.length;for(s=0;s<this.patternsArr.length;s++){var f=c,a=l,u=1,v=this.patternsArr[s].concat();for(e=0;e<v.length;e++){for(b=v.slice(0,e+1),h=null;u<=f.length;)if(k=f.substring(0,u),h=new RegExp("^"+b.join("")+"$").exec(k),h){u++;break}else if(this.exps[e]){u++;continue}else{d=v[e].replace(/^\\/,"");f=f.substring(0,u-1)+d+f.substring(u-1);u<a+2&&a++;continue}if(u>f.length){if(h)return{value:f,position:a+(n.length>0?n.length-1:0)};break}}}return null},n}();
//# sourceMappingURL=regformatter.min.js.map
