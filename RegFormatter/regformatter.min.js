var RegFormatter=function(){function n(t){var u=this,s=t.element,r,v,y,p,w,b,k,d;if(s&&s.tagName.toUpperCase()!=="INPUT"&&s.tagName.toUpperCase()!=="TEXTAREA")throw"Element should be <input />";this.element=s;r=t.format;this.format=r;for(var g="",e=[],c=[],f="",it=[".","[","]","(",")","+","-","*","?","{","}","|","/","^","$"],nt=["%","[","(","{"],tt=["%","]",")","}"],l=!1,a=!1,o=[],h=function(n){f===""||n&&(o.length>1||i+1<r.length&&r[i+1]==="{")||(g+=f,e.push(f),c.push(n),f="")},i=0;i<r.length;i++){if(a){f+=r[i];a=!1;h(l);continue}if(r[i]==="\\"){f+=r[i];a=!0;continue}if(r[i]==="%")if(l)if(o.length&&o[o.length-1]==="%"){o.pop();h(!0);l=!1;continue}else throw"Invalid pattern '"+r+"' at position "+i+" '"+r[i]+"'";else{o.push(r[i]);h(!1);l=!0;continue}if(!l){f+=it.indexOf(r[i])>=0?"\\"+r[i]:r[i];h(!1);continue}if(nt.indexOf(r[i])>=0){o.push(r[i]);f+=r[i];h(!0);continue}if(tt.indexOf(r[i])>=0)if(o.length&&o[o.length-1]===nt[tt.indexOf(r[i])]){o.pop();f+=r[i];h(!0);continue}else throw"Invalid pattern '"+r+"' at position "+i+" '"+r[i]+"'";f+=r[i];h(!0)}if(o.length)throw"Invalid pattern '"+r+"' at position "+(r.length-1)+" '"+r[r.length-1]+"'";for(i=0;i<e.length;){if(c[i]&&(v=/\{(\d)\}$/,f=e[i],y=v.exec(f),y)){for(p=parseInt(y[1]),f=f.replace(v,""),e[i]=f,w=1;w<p;w++)e.splice(i,0,f),c.splice(i,0,!0);i+=p-1}i++}for(this.patternsOriginal=e.concat(),b=function(n,t){for(var r,s,h,f,e,o=!0,i=t;i<n.length;i++)if(c[i]&&(r=/\{(\d),(\d)\}$/.exec(n[i]),r)){for(o=!1,s=parseInt(r[1]),h=parseInt(r[2]),f=s;f<=h;f++)e=n.concat(),e[i]=e[i].replace(/\{(\d),(\d)\}$/,"{"+f+"}"),b(e,i+1);break}o&&u.patternsArr.push(n)},this.patternsArr=[],b(e,0),i=0;i<e.length;i++)/\{\d,\d\}/.test(e[i])&&(e[i]=e[i].replace(/\{\d,(\d)\}/,"{1,$1}"));if(this.pattern=g,this.patterns=e,this.exps=c,s){var rt=function(t){var f,r;if(t=t||window.event,f=t.keyCode||t.charCode,f===8||f===46){if(!u.element.value)return!1;var o=n.getCaretPosition(u.element),i=o.selectionStart,e=o.selectionEnd;if(i===e&&(f===8?i--:e=i+1),r=u.write("",u.element.value,i,e),r)return u.element.value=r.value,u.oldValue=r.value,i>r.value.length&&(i=r.value.length),n.setCaretPosition(u.element,i),n.preventEvent(t),!1}return!0},ut=function(t){t=t||window.event;var o=String.fromCharCode(t.keyCode||t.charCode),r=n.getCaretPosition(u.element),f=r.selectionStart,e=r.selectionEnd,i=u.write(o,u.element.value,f,e===f?null:e);return i&&(u.element.value=i.value,u.oldValue=i.value,n.setCaretPosition(u.element,i.position+1)),n.preventEvent(t),!1},ft=function(t){var r;if(t=t||window.event,r=t.clipboardData.getData("text/plain"),r){var f=n.getCaretPosition(u.element),e=f.selectionStart,o=f.selectionEnd,i=u.write(r,u.element.value,e,o===e?null:o);i&&(u.element.value=i.value,u.oldValue=i.value,n.setCaretPosition(u.element,i.position+1))}return n.preventEvent(t),!1},et=function(){var t=u.write(u.element.value,"",0);t?(u.element.value=t.value,u.oldValue=t.value,n.setCaretPosition(u.element,t.value.length)):u.element.value=u.oldValue};n.addEvent(s,"keydown",rt);n.addEvent(s,"keypress",ut);n.addEvent(s,"paste",ft);n.addEvent(s,"input",et);k=this.element.value;k&&(d=this.write(k,"",0,0),this.element.value=d?d.value:"",this.oldValue=this.element.value)}}return Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0;i<this.length;i++)if(this[i]===n)return i;return-1}),n.addEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i)},n.preventEvent=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},n.getCaretPosition=function(n){if(document.selection){n.focus();var t=document.selection.createRange(),i=t.text.length;return t.moveStart("character",-n.value.length),{selectionStart:t.text.length-i,selectionEnd:t.text.length}}return{selectionStart:n.selectionStart,selectionEnd:n.selectionEnd}},n.setCaretPosition=function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},n.prototype.checkValue=function(n){var i=this.patternsOriginal.concat(),r,u,t,f;for(i.pop(),r=this.patterns.concat(),u=this.patterns.length,t=u;t>0;t--){if(f=i.join("")+r.pop(),new RegExp("^"+f+"$").test(n))return t;i.pop()}return 0},n.prototype.value=function(n){var r=this,u="",f,i,t,e;for(n=n!=undefined?n:this.element?this.element.value:"",f=function(n){var t=r.patternsOriginal.concat(),u,i;for(t.pop(),u=r.patterns.concat(),i=0;i<r.patterns.length;i++)if(t.push(u.pop()),new RegExp("^"+t.join("")+"$").test(n))break;else t.pop(),t.pop();return t},i=f(n),t=0;t<i.length;t++)this.exps[t]&&(e=n.match(new RegExp("^"+i.slice(0,t+1).join(""))),u+=e[0].replace(new RegExp("^"+i.slice(0,t).join("")),""));return u},n.prototype.write=function(n,t,i,r){var c=this.value(t),l,a,o,p,s,e,b,h,k,d;if(c===""&&n==="")return{value:t,position:t.length};if(r){var w=this.value(t.substring(0,i)),g=this.value(t.substring(0,r)),nt=c.substring(g.length);l=w+n+nt;a=w.length}else o=this.value(t.substring(0,i)),p=c.substring(o.length),l=o+n+p,a=o.length;for(s=0;s<this.patternsArr.length;s++){var f=l,v=a,u=1,y=this.patternsArr[s].concat();for(e=0;e<y.length;e++){for(b=y.slice(0,e+1),h=null;u<=f.length;)if(k=f.substring(0,u),h=new RegExp("^"+b.join("")+"$").exec(k),h){u++;break}else if(this.exps[e]){u++;continue}else{d=y[e].replace(/^\\/,"");f=f.substring(0,u-1)+d+f.substring(u-1);u<v+2&&v++;continue}if(u>f.length){if(h)return{value:f,position:v+(n.length>0?n.length-1:0)};break}}}return null},n}();
//# sourceMappingURL=regformatter.min.js.map
