var RegFormatter=function(){function n(i){var f=this,e=i.element,o;if(e&&e.tagName.toUpperCase()!=="INPUT"&&e.tagName.toUpperCase()!=="TEXTAREA")throw"Element should be <input />";if(!i.format&&!i.formats)throw"Format is not specified";if(this.element=e,o=i.formats||[],i.format&&o.unshift(i.format),this.reset(o),e){var s=function(t){var o,e;if(t=t||window.event,o=t.keyCode||t.charCode,o===8||o===46){if(!f.element.value)return;var h=r(f.element),i=h.selectionStart,s=h.selectionEnd;i===s&&(o===8?i--:s=i+1);e=f.write("",f.element.value,i,s);e&&(f.element.value=e.value,f.oldValue=e.value,i>e.value.length&&(i=e.value.length),n.setCaretPosition(f.element,i),u(t))}},h=function(t){t=t||window.event;var h=String.fromCharCode(t.keyCode||t.charCode),e=r(f.element),o=e.selectionStart,s=e.selectionEnd,i=f.write(h,f.element.value,o,s===o?null:s);i&&(f.element.value=i.value,f.oldValue=i.value,n.setCaretPosition(f.element,i.position+1));u(t)},c=function(){var t=f.write(f.element.value,"",0);t?(f.element.value=t.value,f.oldValue=t.value,n.setCaretPosition(f.element,t.value.length)):f.element.value=f.oldValue},l=function(t){var e;if(t=t||window.event,e=t.clipboardData.getData("text/plain"),e){var o=r(f.element),s=o.selectionStart,h=o.selectionEnd,i=f.write(e,f.element.value,s,h===s?null:h);i&&(f.element.value=i.value,f.oldValue=i.value,n.setCaretPosition(f.element,i.position+1))}u(t)},a=function(){var i=r(f.element),u=i.selectionStart,e=i.selectionEnd,t=f.write("",f.element.value,u,e===u?null:e);t&&setTimeout(function(){f.element.value=t.value;f.oldValue=t.value;n.setCaretPosition(f.element,t.position)},10)};t(e,"keydown",s);t(e,"keypress",h);t(e,"input",c);t(e,"paste",l);t(e,"cut",a)}}var i;Array.prototype.indexOf||(Array.prototype.indexOf=function(n,t){for(var i=t||0;i<this.length;i++)if(this[i]===n)return i;return-1});var t=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i)},u=function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},r=function(n){if(document.selection){n.focus();var t=document.selection.createRange(),i=t.text.length;return t.moveStart("character",-n.value.length),{selectionStart:t.text.length-i,selectionEnd:t.text.length}}return{selectionStart:n.selectionStart,selectionEnd:n.selectionEnd}};return n.setCaretPosition=function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},i=function(n){for(var i="",t=0;t<n.length;t++)i+=n[t].value;return i},n.prototype.reset=function(n){var a=[],y,i,r,ft,c,h,o,k,l,p,d,w,g,nt;if(typeof n=="string")a.push(n);else if(Array.isArray(n))a=n.concat();else throw"Invalid argument 'format'";var et=[".","[","]","(",")","+","-","*","?","{","}","|","/","^","$"],tt=["%","[","(","{"],it=["%","]",")","}"],ot=["+","*","?","|","^","$"],rt=[],e=[],t="",u=!1,v=!1,f=[],b="",s=function(r){t===""||r&&(f.length>1||i+1<n.length&&n.charAt(i+1)==="{")||(e.push({value:t,isExp:r}),b+=t,t="")},ut=function(n,t,i){for(var u,f,e,r=t;r>=0;r--)if(u=n[r],u.isExp&&Array.isArray(u.value)){for(f=0;f<u.value.length;f++)e=u.value[f].concat(i),ut(n,r-1,e);break}else i.unshift(u);r<=0&&rt.push(i)};for(y=0;y<a.length;y++){for(n=a[y],e=[],t="",u=!1,v=!1,f=[],b="",i=0;i<n.length;i++){if(r=n.charAt(i),v){t+=r;v=!1;s(u);continue}if(r==="\\"){t+=r;v=!0;continue}if(r==="%")if(u)if(f.length&&f[f.length-1]==="%"){f.pop();s(u);u=!1;continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";else{f.push(r);s(u);u=!0;continue}if(!u){t+=et.indexOf(r)>=0?"\\"+r:r;s(u);continue}if(tt.indexOf(r)>=0){f.push(r);t+=r;s(u);continue}if(it.indexOf(r)>=0)if(f.length&&f[f.length-1]===tt[it.indexOf(r)]){f.pop();t+=r;s(u);continue}else throw"Invalid pattern '"+n+"' at position "+i+" '"+r+"'";ot.indexOf(r)>=0&&(t+="\\"+r,s(u));t+=r;s(u)}if(f.length)throw"Invalid pattern '"+n+"' at position "+(n.length-1)+" '"+n[n.length-1]+"'";for(ft=new RegExp(b),ft=null,i=0;i<e.length;i++)if(t=e[i],t.isExp)if(c=/\{(\d)\}$/,h=c.exec(t.value),h){for(o=parseInt(h[1]),t.value=t.value.replace(c,""),e.splice(i,1),k=0;k<o;k++)e.splice(i,0,t);i+=o-1}else if(/(^|[^\\])\{(\d)\}/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(i=0;i<e.length;i++)if(t=e[i],t.isExp)if(c=/\{(\d),(\d)\}$/,h=c.exec(t.value),h){if(l=parseInt(h[1]),p=parseInt(h[2]),!l||!p||l<1||l>p)throw"Invalid pattern '"+n+"' in '"+t.value+"'";if(t.value=t.value.replace(c,""),!t.value)throw"Invalid pattern '"+n+"' in '"+t.value+"'";for(d=[],w=[],o=0;o<l-1;o++)w.push(t);for(o=l;o<=p;o++)w.push(t),d.push(w.concat());e.splice(i,1,{value:d,isExp:t.isExp})}else if(/(^|[^\\])\{(\d),(\d)\}/.test(t.value))throw"Invalid pattern '"+n+"' in '"+t.value+"'";ut(e,e.length-1,[])}this.formats=a;this.patterns=rt;this.element&&(g=this.element.value,g&&(nt=this.write(g,"",0,0),this.element.value=nt?nt.value:"",this.oldValue=this.element.value))},n.prototype.value=function(n){var u=this,f="",t,r,e;for(n=n!=undefined?n:this.element?this.element.value:"",r=null,t=0;t<u.patterns.length;t++)if(r=u.patterns[t].slice(0,n.length),new RegExp("^"+i(r)+"$").test(n))break;else r=null;if(!r)return null;for(t=0;t<r.length;t++)r[t].isExp&&(e=n.match(new RegExp("^"+i(r.slice(0,t+1)))),f+=e[0].replace(new RegExp("^"+i(r.slice(0,t))),""));return f},n.prototype.write=function(n,t,r,u){var a=this.value(t),v,y,s,w,h,o,k,l,d,g;if(a===""&&n==="")return{value:"",position:0};if(u){var b=this.value(t.substring(0,r)),nt=this.value(t.substring(0,u)),tt=a.substring(nt.length);v=b+n+tt;y=b.length}else s=this.value(t.substring(0,r)),w=a.substring(s.length),v=s+n+w,y=s.length;for(h=0;h<this.patterns.length;h++){var c=this.patterns[h],e=v,p=y,f=1;for(o=0;o<c.length;o++){for(k=c.slice(0,o+1),l=null;f<=e.length;)if(d=e.substring(0,f),l=new RegExp("^"+i(k)+"$").exec(d),l){f++;break}else if(c[o].isExp){f++;continue}else{g=c[o].value.replace(/^\\/,"");e=e.substring(0,f-1)+g+e.substring(f-1);f<p+n.length+1&&p++;continue}if(f>e.length){if(l)return{value:e,position:p+(n.length>0?n.length-1:0)};break}}}return null},n}();
//# sourceMappingURL=regformatter.min.js.map
